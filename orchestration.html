<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
  <meta name="description" content="Claude Code CLIì—ì„œ Skill, Agent, Hookì„ ì¡°í•©í•˜ì—¬ ë©€í‹° ì—ì´ì „íŠ¸ ì›Œí¬í”Œë¡œìš°ë¥¼ êµ¬ì¶•í•˜ëŠ” ê°€ì´ë“œ">
  <meta name="keywords" content="Claude Code, Skill, Agent, Hook, ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜, ì›Œí¬í”Œë¡œìš°">
  <meta name="theme-color" content="#6366f1">

  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">

  <title>ë©€í‹° ì—ì´ì „íŠ¸ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ ê°€ì´ë“œ - MyCoding Book</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable-dynamic-subset.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&display=swap">

  <!-- Prism.js for Syntax Highlighting -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css">

  <!-- Styles -->
  <link rel="stylesheet" href="assets/css/style.css">

  <!-- Mermaid -->
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>

  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json">

  <!-- Icons -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ­</text></svg>">
  <link rel="icon" type="image/png" sizes="192x192" href="assets/icons/icon-192x192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="assets/icons/icon-512x512.png">
  <link rel="apple-touch-icon" href="assets/icons/icon-192x192.png">
</head>
<body>
  <!-- Skip Link -->
  <a href="#main-content" class="skip-link">ë³¸ë¬¸ìœ¼ë¡œ ê±´ë„ˆë›°ê¸°</a>

  <!-- Header -->
  <header class="header">
    <div class="header-content">
      <a href="index.html" class="header-logo">
        <span>ğŸ“š</span>
        <span>MyCoding Book</span>
      </a>

      <div class="header-actions">
        <!-- Document Selector -->
        <div class="doc-selector">
          <button class="doc-selector-btn" aria-expanded="false" aria-haspopup="true">
            <span>ğŸ­ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜</span>
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </button>
          <div class="doc-selector-dropdown" role="menu">
            <a href="orchestration.html" class="doc-selector-item active" role="menuitem">
              <span>ğŸ­</span>
              <span>ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ ê°€ì´ë“œ</span>
            </a>
            <a href="mcp-guide.html" class="doc-selector-item" role="menuitem">
              <span>ğŸ”Œ</span>
              <span>MCP ì—°ê³„ ê°€ì´ë“œ</span>
            </a>
          </div>
        </div>

        <!-- Mobile Menu Button -->
        <button class="mobile-menu-btn" aria-label="ë©”ë‰´ ì—´ê¸°">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
          </svg>
        </button>

        <!-- Search Button -->
        <button class="search-btn" aria-label="ê²€ìƒ‰">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.35-4.35"></path>
          </svg>
          <span>ê²€ìƒ‰...</span>
          <span class="search-kbd"><kbd>Ctrl</kbd><kbd>K</kbd></span>
        </button>

        <!-- Theme Toggle -->
        <button class="theme-toggle" aria-label="ë‹¤í¬ëª¨ë“œ ì „í™˜">
          <span class="theme-toggle-thumb">â˜€ï¸</span>
        </button>
      </div>
    </div>
  </header>

  <!-- Reading Progress -->
  <div class="reading-progress">
    <div class="reading-progress-bar"></div>
  </div>

  <!-- Sidebar Overlay (Mobile) -->
  <div class="sidebar-overlay"></div>

  <!-- Sidebar -->
  <aside class="sidebar" role="navigation" aria-label="ëª©ì°¨">
    <button class="sidebar-close" aria-label="ë©”ë‰´ ë‹«ê¸°">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    </button>

    <div class="sidebar-header">
      <div class="sidebar-title">ëª©ì°¨</div>
      <div class="sidebar-doc-title">ğŸ­ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ ê°€ì´ë“œ</div>
    </div>

    <nav class="sidebar-nav">
      <!-- Section 1 -->
      <div class="sidebar-section expanded">
        <div class="sidebar-section-title" data-section="overview" tabindex="0" role="button" aria-expanded="true">
          <span><span class="sidebar-section-icon">ğŸ“‹</span>1. ê°œìš”</span>
          <span class="sidebar-section-arrow">â–¸</span>
        </div>
        <div class="sidebar-items">
          <a href="#skill-vs-agent" class="sidebar-item">1.1 Skill vs Agent ê¸°ë³¸ ê°œë…</a>
          <a href="#when-to-use" class="sidebar-item">1.2 ì–¸ì œ ë¬´ì—‡ì„ ì“°ëŠ”ê°€</a>
        </div>
      </div>

      <!-- Section 2 -->
      <div class="sidebar-section">
        <div class="sidebar-section-title" data-section="architecture" tabindex="0" role="button" aria-expanded="false">
          <span><span class="sidebar-section-icon">ğŸ—ï¸</span>2. í•µì‹¬ ì•„í‚¤í…ì²˜</span>
          <span class="sidebar-section-arrow">â–¸</span>
        </div>
        <div class="sidebar-items">
          <a href="#system-structure" class="sidebar-item">2.1 Claude Code ì‹œìŠ¤í…œ êµ¬ì¡°</a>
          <a href="#session-isolation" class="sidebar-item">2.2 ì„¸ì…˜ ë…ë¦½ì„±</a>
        </div>
      </div>

      <!-- Section 3 -->
      <div class="sidebar-section">
        <div class="sidebar-section-title" data-section="patterns" tabindex="0" role="button" aria-expanded="false">
          <span><span class="sidebar-section-icon">ğŸ§©</span>3. ì¡°í•© íŒ¨í„´</span>
          <span class="sidebar-section-arrow">â–¸</span>
        </div>
        <div class="sidebar-items">
          <a href="#agent-in-skill" class="sidebar-item">3.1 Agent ì•ˆì— Skill</a>
          <a href="#skill-in-agent" class="sidebar-item">3.2 Skill ì•ˆì— Agent</a>
          <a href="#why-skill-orchestrator" class="sidebar-item">3.3 ì™œ Skillì´ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°ë¡œ ê°•ë ¥í•œê°€</a>
        </div>
      </div>

      <!-- Section 4 -->
      <div class="sidebar-section">
        <div class="sidebar-section-title" data-section="hooks" tabindex="0" role="button" aria-expanded="false">
          <span><span class="sidebar-section-icon">ğŸª</span>4. Hook ì‹œìŠ¤í…œ</span>
          <span class="sidebar-section-arrow">â–¸</span>
        </div>
        <div class="sidebar-items">
          <a href="#hook-definition" class="sidebar-item">4.1 Hook ì •ì˜ ìœ„ì¹˜</a>
          <a href="#hook-trigger" class="sidebar-item">4.2 Hook ë°œë™ ì¡°ê±´</a>
          <a href="#hook-env" class="sidebar-item">4.3 Hook í™˜ê²½ë³€ìˆ˜</a>
          <a href="#hook-exit-code" class="sidebar-item">4.4 Hook ì¢…ë£Œ ì½”ë“œ</a>
          <a href="#hook-system-level" class="sidebar-item">4.5 ì‹œìŠ¤í…œ ë ˆë²¨ ë°œë™ ì›ë¦¬</a>
          <a href="#hook-filtering" class="sidebar-item">4.6 ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì»¨í…ìŠ¤íŠ¸ í•„í„°ë§</a>
          <a href="#hook-state" class="sidebar-item">4.7 ìƒíƒœ ê´€ë¦¬</a>
        </div>
      </div>

      <!-- Section 5 -->
      <div class="sidebar-section">
        <div class="sidebar-section-title" data-section="advanced" tabindex="0" role="button" aria-expanded="false">
          <span><span class="sidebar-section-icon">âš¡</span>5. ê³ ê¸‰ ì›Œí¬í”Œë¡œìš°</span>
          <span class="sidebar-section-arrow">â–¸</span>
        </div>
        <div class="sidebar-items">
          <a href="#branching" class="sidebar-item">5.1 ë¶„ê¸°</a>
          <a href="#validation" class="sidebar-item">5.2 ê²€ì¦</a>
          <a href="#loop-control" class="sidebar-item">5.3 ë°˜ë³µ ì œí•œ</a>
          <a href="#aggregation" class="sidebar-item">5.4 ê²°ê³¼ ì¢…í•©</a>
          <a href="#reflection" class="sidebar-item">5.5 íšŒê³ </a>
          <a href="#multi-branch" class="sidebar-item">5.6 ë‹¤ì¤‘ ë¶„ê¸°</a>
          <a href="#dag" class="sidebar-item">5.7 ì›Œí¬íŠ¸ë¦¬/DAG</a>
          <a href="#consensus" class="sidebar-item">5.8 íˆ¬í‘œ/í•©ì˜</a>
          <a href="#racing" class="sidebar-item">5.9 ê²½ìŸ</a>
          <a href="#checkpoint" class="sidebar-item">5.10 ì²´í¬í¬ì¸íŠ¸/ë¡¤ë°±</a>
          <a href="#error-handling" class="sidebar-item">5.11 ì—ëŸ¬ í•¸ë“¤ë§</a>
        </div>
      </div>

      <!-- Section 6 -->
      <div class="sidebar-section">
        <div class="sidebar-section-title" data-section="hook-branching" tabindex="0" role="button" aria-expanded="false">
          <span><span class="sidebar-section-icon">ğŸ”€</span>6. ì‹¤ì „ Hook ë¶„ê¸° íŒ¨í„´</span>
          <span class="sidebar-section-arrow">â–¸</span>
        </div>
        <div class="sidebar-items">
          <a href="#hook-branching-concept" class="sidebar-item">6.1 Hook ë¶„ê¸° í•µì‹¬ ê°œë…</a>
          <a href="#exit-code-control" class="sidebar-item">6.2 Exit Code ì œì–´</a>
          <a href="#transcript-parsing" class="sidebar-item">6.3 Transcript íŒŒì‹± ë¶„ê¸°</a>
          <a href="#workflow-example" class="sidebar-item">6.4 ì‹¤ì „ ì›Œí¬í”Œë¡œìš° ì˜ˆì‹œ</a>
          <a href="#parallel-orchestration" class="sidebar-item">6.5 ë³‘ë ¬ Agent ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜</a>
        </div>
      </div>

      <!-- Section 7 -->
      <div class="sidebar-section">
        <div class="sidebar-section-title" data-section="examples" tabindex="0" role="button" aria-expanded="false">
          <span><span class="sidebar-section-icon">ğŸ’»</span>7. ì‹¤ì „ ì˜ˆì‹œ</span>
          <span class="sidebar-section-arrow">â–¸</span>
        </div>
        <div class="sidebar-items">
          <a href="#example-basic" class="sidebar-item">7.1 ê¸°ë³¸: ë‹¨ì¼ ê²€ì¦</a>
          <a href="#example-intermediate" class="sidebar-item">7.2 ì¤‘ê¸‰: íšŒê³  ë£¨í”„</a>
          <a href="#example-advanced" class="sidebar-item">7.3 ê³ ê¸‰: í’€ íŒŒì´í”„ë¼ì¸</a>
          <a href="#project-structure" class="sidebar-item">7.4 í”„ë¡œì íŠ¸ êµ¬ì¡°</a>
          <a href="#agent-definition" class="sidebar-item">7.5 Agent ì •ì˜ íŒŒì¼</a>
          <a href="#utils" class="sidebar-item">7.6 ê³µí†µ ìœ í‹¸ë¦¬í‹°</a>
          <a href="#skill-tools" class="sidebar-item">7.7 Skill ë„êµ¬ ëª©ë¡</a>
        </div>
      </div>

      <!-- Section 8 -->
      <div class="sidebar-section">
        <div class="sidebar-section-title" data-section="limitations" tabindex="0" role="button" aria-expanded="false">
          <span><span class="sidebar-section-icon">ğŸš€</span>8. í•œê³„ì  ë° í™•ì¥</span>
          <span class="sidebar-section-arrow">â–¸</span>
        </div>
        <div class="sidebar-items">
          <a href="#cli-limits" class="sidebar-item">8.1 Claude Code CLI í•œê³„</a>
          <a href="#agent-sdk" class="sidebar-item">8.2 Agent SDKë¡œ ì „í™˜ ì‹œì </a>
          <a href="#mcp-extension" class="sidebar-item">8.3 MCPë¡œ í™•ì¥</a>
        </div>
      </div>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="main" id="main-content">
    <!-- Card Tabs -->
    <div class="card-tabs-wrapper">
      <div class="card-tabs" role="tablist" aria-label="ì„¹ì…˜ íƒ­">
        <a href="#overview" class="card-tab active" data-section="overview" role="tab" aria-selected="true" tabindex="0">
          <span class="card-tab-icon">ğŸ“‹</span>
          <span class="card-tab-title">ê°œìš”</span>
        </a>
        <a href="#architecture" class="card-tab" data-section="architecture" role="tab" aria-selected="false" tabindex="-1">
          <span class="card-tab-icon">ğŸ—ï¸</span>
          <span class="card-tab-title">ì•„í‚¤í…ì²˜</span>
        </a>
        <a href="#patterns" class="card-tab" data-section="patterns" role="tab" aria-selected="false" tabindex="-1">
          <span class="card-tab-icon">ğŸ§©</span>
          <span class="card-tab-title">ì¡°í•© íŒ¨í„´</span>
        </a>
        <a href="#hooks" class="card-tab" data-section="hooks" role="tab" aria-selected="false" tabindex="-1">
          <span class="card-tab-icon">ğŸª</span>
          <span class="card-tab-title">Hook</span>
        </a>
        <a href="#advanced" class="card-tab" data-section="advanced" role="tab" aria-selected="false" tabindex="-1">
          <span class="card-tab-icon">âš¡</span>
          <span class="card-tab-title">ê³ ê¸‰</span>
        </a>
        <a href="#examples" class="card-tab" data-section="examples" role="tab" aria-selected="false" tabindex="-1">
          <span class="card-tab-icon">ğŸ’»</span>
          <span class="card-tab-title">ì˜ˆì‹œ</span>
        </a>
        <a href="#limitations" class="card-tab" data-section="limitations" role="tab" aria-selected="false" tabindex="-1">
          <span class="card-tab-icon">ğŸš€</span>
          <span class="card-tab-title">í™•ì¥</span>
        </a>
      </div>
    </div>

    <!-- Content -->
    <div class="content">
      <!-- Header -->
      <header class="content-header">
        <h1 class="content-title">ë©€í‹° ì—ì´ì „íŠ¸ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ ê°€ì´ë“œ</h1>
        <div class="content-meta">
          <span class="content-meta-item">ğŸ“… 2025-01-02</span>
          <span class="content-meta-item">â±ï¸ ì•½ 20ë¶„</span>
        </div>
        <p style="margin-top: 1rem; color: var(--color-text-secondary);">
          Claude Code CLIì—ì„œ Skill, Agent, Hookì„ ì¡°í•©í•˜ì—¬ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ë©€í‹° ì—ì´ì „íŠ¸ ì›Œí¬í”Œë¡œìš°ë¥¼ êµ¬ì¶•í•˜ëŠ” ë°©ë²•ì„ ë‹¤ë£¹ë‹ˆë‹¤.
        </p>
        <div class="content-tags">
          <span class="content-tag">Skill</span>
          <span class="content-tag">Agent</span>
          <span class="content-tag">Hook</span>
          <span class="content-tag">Workflow</span>
          <span class="content-tag">Pipeline</span>
        </div>
      </header>

      <!-- Section 1: ê°œìš” -->
      <section id="overview">
        <h2>1. ê°œìš”</h2>

        <h3 id="skill-vs-agent">1.1 Skill vs Agent ê¸°ë³¸ ê°œë…</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th></th>
                <th>Skill</th>
                <th>Agent</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>ì •ì˜</strong></td>
                <td>ì¬ì‚¬ìš© ê°€ëŠ¥í•œ í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿</td>
                <td>ë…ë¦½ëœ ì»¨í…ìŠ¤íŠ¸ì˜ ì‘ì—…ì</td>
              </tr>
              <tr>
                <td><strong>ìœ„ì¹˜</strong></td>
                <td><code>.claude/skills/</code></td>
                <td><code>.claude/agents/</code></td>
              </tr>
              <tr>
                <td><strong>íŠ¹ì§•</strong></td>
                <td>ëª…ë ¹ì–´ë¡œ í˜¸ì¶œ (<code>/skill-name</code>)</td>
                <td>Task ë„êµ¬ë¡œ í˜¸ì¶œ</td>
              </tr>
              <tr>
                <td><strong>ì»¨í…ìŠ¤íŠ¸</strong></td>
                <td>ë©”ì¸ ëª¨ë¸ê³¼ ê³µìœ </td>
                <td>ë…ë¦½/ê²©ë¦¬ë¨</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3 id="when-to-use">1.2 ì–¸ì œ ë¬´ì—‡ì„ ì“°ëŠ”ê°€</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>ìƒí™©</th>
                <th>ì„ íƒ</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>"ì´ê±° ìì£¼ ì“°ë‹ˆê¹Œ ëª…ë ¹ì–´ë¡œ ë§Œë“¤ì"</td>
                <td><strong>Skill</strong></td>
              </tr>
              <tr>
                <td>"ì•Œì•„ì„œ íƒìƒ‰í•˜ê³  íŒë‹¨í•´ì•¼ í•´"</td>
                <td><strong>Agent</strong></td>
              </tr>
              <tr>
                <td>"ëª…ë ¹ì–´ì¸ë° ë‚´ë¶€ê°€ ë³µì¡í•´"</td>
                <td><strong>Skill â†’ Agent</strong></td>
              </tr>
              <tr>
                <td>"ì‘ì—… ì¤‘ì— ì •í˜•í™”ëœ ë‹¨ê³„ í•„ìš”"</td>
                <td><strong>Agent â†’ Skill</strong></td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="callout callout-tip">
          <div class="callout-title">ğŸ’¡ í•µì‹¬ ì°¨ì´ì </div>
          <div class="callout-content">
            <ul>
              <li>AgentëŠ” í•˜ìœ„ì— ë‹¤ë¥¸ Agentë¥¼ ë‘˜ ìˆ˜ ì—†ìŒ</li>
              <li>Skill ì•ˆì—ì„œëŠ” ì—¬ëŸ¬ Agentë¥¼ ë³‘ë ¬ë¡œ í˜¸ì¶œ ê°€ëŠ¥</li>
              <li>ì´ ì°¨ì´ê°€ <strong>Skillì„ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°ë¡œ ë§Œë“œëŠ” í•µì‹¬</strong></li>
            </ul>
          </div>
        </div>
      </section>

      <!-- Section 2: í•µì‹¬ ì•„í‚¤í…ì²˜ -->
      <section id="architecture">
        <h2>2. í•µì‹¬ ì•„í‚¤í…ì²˜</h2>

        <h3 id="system-structure">2.1 Claude Code ì‹œìŠ¤í…œ êµ¬ì¡°</h3>

        <div class="diagram-wrapper">
          <div class="diagram-title">ğŸ“Š Claude Code ì‹œìŠ¤í…œ êµ¬ì¡°</div>
          <div class="mermaid">
flowchart TB
    subgraph System["Claude Code ì‹œìŠ¤í…œ (Harness/Runtime)"]
        direction TB
        Tools["ë„êµ¬ ì‹¤í–‰ ê´€ë¦¬"]
        Hooks["Hook ë°œë™"]
        Sessions["ì„¸ì…˜ ê´€ë¦¬"]

        subgraph Models["ëª¨ë¸ ë ˆì´ì–´"]
            Main["ë©”ì¸ ëª¨ë¸\n(LLM)"]
            Agent["Agent ëª¨ë¸\n(LLM)"]
        end
    end

    Tools --> Models
    Hooks --> Models
    Sessions --> Models
          </div>
        </div>

        <div class="callout callout-info">
          <div class="callout-title">â„¹ï¸ ì¤‘ìš”</div>
          <div class="callout-content">
            <p>ëª¨ë¸(LLM)ê³¼ ì‹œìŠ¤í…œ(Runtime)ì€ ë¶„ë¦¬ë˜ì–´ ìˆìŠµë‹ˆë‹¤:</p>
            <ul>
              <li><strong>ëª¨ë¸</strong>: ìƒê°í•˜ê³  ë„êµ¬ í˜¸ì¶œ ìš”ì²­</li>
              <li><strong>ì‹œìŠ¤í…œ</strong>: ì‹¤ì œ ë„êµ¬ ì‹¤í–‰, Hook ë°œë™, ì„¸ì…˜ ê´€ë¦¬</li>
            </ul>
          </div>
        </div>

        <h3 id="session-isolation">2.2 ì„¸ì…˜ ë…ë¦½ì„±</h3>

        <div class="diagram-wrapper">
          <div class="diagram-title">ğŸ“Š ì„¸ì…˜ ë…ë¦½ì„±</div>
          <div class="mermaid">
flowchart TB
    Main["ë©”ì¸ ëª¨ë¸ (ì„¸ì…˜ A)"]

    Main --> Read["settings.json ì½ê¸° âœ…"]
    Main --> Hook1["Hook ì ìš© âœ…\n(ì‹œìŠ¤í…œì´ ë°œë™)"]
    Main --> Task["Task ë„êµ¬ë¡œ Agent í˜¸ì¶œ"]

    Task --> Agent["Agent (ì„¸ì…˜ B)\në…ë¦½/ê²©ë¦¬"]

    Agent --> NoRead["settings.json ì§ì ‘ ì½ê¸° âŒ"]
    Agent --> NoHook["Hook ì¸ì‹ âŒ\n(í•˜ì§€ë§Œ ì‹œìŠ¤í…œì´ ë°œë™í•¨)"]
    Agent --> Result["ê²°ê³¼ë§Œ ë°˜í™˜"]

    Result --> Main
          </div>
        </div>

        <div class="callout callout-warning">
          <div class="callout-title">âš ï¸ ì¤‘ìš” êµ¬ë¶„</div>
          <div class="callout-content">
            <ul>
              <li><strong>ëª¨ë¸ ê´€ì </strong>: AgentëŠ” Hookì˜ ì¡´ì¬ë¥¼ ëª¨ë¦„</li>
              <li><strong>ì‹œìŠ¤í…œ ê´€ì </strong>: Agentê°€ ë„êµ¬ í˜¸ì¶œí•´ë„ Hookì€ ë°œë™ë¨</li>
            </ul>
            <p>AgentëŠ” <strong>ê²©ë¦¬ëœ ì»¨í…ìŠ¤íŠ¸</strong>ì—ì„œ ì‹¤í–‰ë˜ì§€ë§Œ, ì‹œìŠ¤í…œ ë ˆë²¨ì˜ Hookì€ ì—¬ì „íˆ ì ìš©ë©ë‹ˆë‹¤.</p>
          </div>
        </div>
      </section>

      <!-- Section 3: ì¡°í•© íŒ¨í„´ -->
      <section id="patterns">
        <h2>3. ì¡°í•© íŒ¨í„´</h2>

        <h3 id="agent-in-skill">3.1 Agent ì•ˆì— Skill</h3>

        <div class="diagram-wrapper">
          <div class="diagram-title">ğŸ“Š Agent â†’ Skill íŒ¨í„´</div>
          <div class="mermaid">
flowchart TB
    Agent["Agent (ë³µì¡í•œ ì‘ì—… ìˆ˜í–‰)"]
    Agent --> Skill["Skill í˜¸ì¶œ\n(íŠ¹ì • ë‹¨ê³„ì—ì„œ)"]
          </div>
        </div>

        <p><strong>ì‚¬ìš© ì¼€ì´ìŠ¤:</strong></p>
        <ul>
          <li>Agentê°€ ì½”ë“œ ë¦¬ë·° ì¤‘ <code>/commit</code> ìŠ¤í‚¬ í˜¸ì¶œ</li>
          <li>Agentê°€ ë¬¸ì„œ ì‘ì„± ì¤‘ <code>/pdf</code> ìŠ¤í‚¬ë¡œ ë³€í™˜</li>
          <li>í° ì‘ì—… íë¦„ ì•ˆì—ì„œ ì •í˜•í™”ëœ ë‹¨ê³„ ì‹¤í–‰</li>
        </ul>

        <h3 id="skill-in-agent">3.2 Skill ì•ˆì— Agent (í•µì‹¬ íŒ¨í„´)</h3>

        <div class="diagram-wrapper">
          <div class="diagram-title">ğŸ“Š Skill â†’ Agent íŒ¨í„´ (ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜)</div>
          <div class="mermaid">
flowchart TB
    Skill["Skill (ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°)"]

    Skill --> A["Agent A\n(ì½”ë“œ ë¶„ì„)"]
    Skill --> B["Agent B\n(í…ŒìŠ¤íŠ¸ ê²€í† )"]
    Skill --> C["Agent C\n(ë¬¸ì„œ ê²€í† )"]

    A --> Result["ê²°ê³¼ ì¢…í•©"]
    B --> Result
    C --> Result

    Result --> Output["ìµœì¢… ì¶œë ¥"]
          </div>
        </div>

        <p><strong>ì‚¬ìš© ì¼€ì´ìŠ¤:</strong></p>
        <ul>
          <li><code>/full-review</code> ìŠ¤í‚¬ë¡œ ì—¬ëŸ¬ ê´€ì  ë™ì‹œ ë¶„ì„</li>
          <li><code>/deploy</code> ìŠ¤í‚¬ë¡œ ë¹Œë“œ, í…ŒìŠ¤íŠ¸, ë°°í¬ íŒŒì´í”„ë¼ì¸</li>
          <li>ë³µì¡í•œ ì›Œí¬í”Œë¡œìš°ë¥¼ ë‹¨ì¼ ëª…ë ¹ì–´ë¡œ ì‹¤í–‰</li>
        </ul>

        <h3 id="why-skill-orchestrator">3.3 ì™œ Skillì´ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°ë¡œ ê°•ë ¥í•œê°€</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th></th>
                <th>Agent</th>
                <th>Skill</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>í•˜ìœ„ Agent</strong></td>
                <td>âŒ ë¶ˆê°€</td>
                <td>âœ… ì—¬ëŸ¬ ê°œ ê°€ëŠ¥</td>
              </tr>
              <tr>
                <td><strong>ë³‘ë ¬ ì‹¤í–‰</strong></td>
                <td>ë‹¨ì¼ íë¦„</td>
                <td>ë™ì‹œ ì‹¤í–‰ ê°€ëŠ¥</td>
              </tr>
              <tr>
                <td><strong>ì—­í• </strong></td>
                <td>ë‹¨ì¼ ì „ë¬¸ê°€</td>
                <td><strong>íŒ€ ë¦¬ë”</strong></td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="callout callout-tip">
          <div class="callout-title">ğŸ’¡ ê¸°ì–µí•˜ì„¸ìš”</div>
          <div class="callout-content">
            <p>Skillì€ <strong>ë²„íŠ¼</strong>, AgentëŠ” <strong>ì¡°ìˆ˜</strong>ë¼ê³  ìƒê°í•˜ë©´ ë©ë‹ˆë‹¤.</p>
          </div>
        </div>
      </section>

      <!-- Section 4: Hook ì‹œìŠ¤í…œ -->
      <section id="hooks">
        <h2>4. Hook ì‹œìŠ¤í…œ</h2>

        <h3 id="hook-definition">4.1 Hook ì •ì˜ ìœ„ì¹˜</h3>

        <pre><code class="language-jsonc">// .claude/settings.json
{
  "hooks": {
    "preToolUse": [
      {
        "matcher": "Task",
        "command": "node .claude/scripts/pre-check.js"
      }
    ],
    "postToolUse": [
      {
        "matcher": "Task",
        "command": "node .claude/scripts/post-validate.js"
      }
    ]
  }
}</code></pre>

        <p>Hookì€ <strong>ì˜¤ì§ settings.jsonì—ì„œë§Œ</strong> ì •ì˜ë©ë‹ˆë‹¤.</p>

        <h3 id="hook-trigger">4.2 Hook ë°œë™ ì¡°ê±´</h3>

        <p><strong>matcher ì¡°ê±´ë§Œ ë§ìœ¼ë©´ ë¬´ì¡°ê±´ ë°œë™ (ì‹œìŠ¤í…œ ë ˆë²¨):</strong></p>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>í˜¸ì¶œ ì£¼ì²´</th>
                <th>Hook ë°œë™</th>
                <th>ì„¤ëª…</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>ì‚¬ìš©ì ì§ì ‘</td>
                <td>âœ…</td>
                <td>ì‚¬ìš©ìê°€ ì§ì ‘ ë„êµ¬ ìš”ì²­</td>
              </tr>
              <tr>
                <td>ë©”ì¸ ëª¨ë¸</td>
                <td>âœ…</td>
                <td>ë©”ì¸ ëª¨ë¸ì´ ë„êµ¬ í˜¸ì¶œ</td>
              </tr>
              <tr>
                <td>Skill ë‚´ì—ì„œ</td>
                <td>âœ…</td>
                <td>Skill ì‹¤í–‰ ì¤‘ ë„êµ¬ í˜¸ì¶œ</td>
              </tr>
              <tr>
                <td>Agent ë‚´ì—ì„œ</td>
                <td>âœ…</td>
                <td>Agentê°€ ë„êµ¬ í˜¸ì¶œí•´ë„ <strong>ì‹œìŠ¤í…œì´</strong> ë°œë™</td>
              </tr>
            </tbody>
          </table>
        </div>

        <p>Hookì€ <strong>"ëˆ„ê°€"ê°€ ì•„ë‹ˆë¼ "ë¬´ì—‡ì„"</strong> ê¸°ì¤€ìœ¼ë¡œ ë°œë™í•©ë‹ˆë‹¤.</p>

        <h3 id="hook-env">4.3 Hook í™˜ê²½ë³€ìˆ˜</h3>

        <p>Hook ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ í™˜ê²½ë³€ìˆ˜:</p>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>í™˜ê²½ë³€ìˆ˜</th>
                <th>ì„¤ëª…</th>
                <th>ì‚¬ìš© ì‹œì </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>CLAUDE_TOOL_INPUT</code></td>
                <td>ë„êµ¬ í˜¸ì¶œ ì…ë ¥ (JSON)</td>
                <td>pre/post</td>
              </tr>
              <tr>
                <td><code>CLAUDE_TOOL_OUTPUT</code></td>
                <td>ë„êµ¬ ì‹¤í–‰ ê²°ê³¼</td>
                <td>postToolUseë§Œ</td>
              </tr>
              <tr>
                <td><code>CLAUDE_TOOL_NAME</code></td>
                <td>í˜¸ì¶œëœ ë„êµ¬ ì´ë¦„</td>
                <td>pre/post</td>
              </tr>
            </tbody>
          </table>
        </div>

        <pre><code class="language-javascript">// í™˜ê²½ë³€ìˆ˜ ì‚¬ìš© ì˜ˆì‹œ
const input = JSON.parse(process.env.CLAUDE_TOOL_INPUT || '{}');
const output = process.env.CLAUDE_TOOL_OUTPUT || '';
const toolName = process.env.CLAUDE_TOOL_NAME || '';</code></pre>

        <h3 id="hook-exit-code">4.4 Hook ì¢…ë£Œ ì½”ë“œ</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>ì¢…ë£Œ ì½”ë“œ</th>
                <th>ì˜ë¯¸</th>
                <th>ê²°ê³¼</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><code>process.exit(0)</code></td>
                <td>ì„±ê³µ/í†µê³¼</td>
                <td>ì‘ì—… ê³„ì† ì§„í–‰</td>
              </tr>
              <tr>
                <td><code>process.exit(1)</code></td>
                <td>ì‹¤íŒ¨/ì°¨ë‹¨</td>
                <td>ì‘ì—… ì¤‘ë‹¨, ì—ëŸ¬ ë°˜í™˜</td>
              </tr>
            </tbody>
          </table>
        </div>

        <pre><code class="language-javascript">// ê²€ì¦ í†µê³¼
if (isValid) {
  process.exit(0);  // ê³„ì† ì§„í–‰
}

// ê²€ì¦ ì‹¤íŒ¨
console.error("ê²€ì¦ ì‹¤íŒ¨ ì´ìœ ");
process.exit(1);  // ì‘ì—… ì¤‘ë‹¨</code></pre>

        <div class="card-tip">
          <p><strong>ğŸ’¡ ë” ì•Œì•„ë³´ê¸°:</strong> exit codeë¥¼ í™œìš©í•œ ì‹¤ì „ ë¶„ê¸° íŒ¨í„´ê³¼ Transcript íŒŒì‹± ë°©ë²•ì€ <a href="#hook-branching">6. ì‹¤ì „ Hook ë¶„ê¸° íŒ¨í„´</a>ì—ì„œ ìì„¸íˆ ë‹¤ë£¹ë‹ˆë‹¤.</p>
        </div>

        <h3 id="hook-system-level">4.5 ì‹œìŠ¤í…œ ë ˆë²¨ ë°œë™ ì›ë¦¬</h3>

        <div class="diagram-wrapper">
          <div class="diagram-title">ğŸ“Š Hook ë°œë™ íë¦„</div>
          <div class="mermaid">
sequenceDiagram
    participant Main as ë©”ì¸ ëª¨ë¸
    participant System as ì‹œìŠ¤í…œ
    participant Agent as Agent ëª¨ë¸

    Main->>System: 1. Task ë„êµ¬ í˜¸ì¶œí• ê²Œ
    System->>System: 2. preToolUse Hook ì‹¤í–‰ âœ…
    System->>Agent: 3. Agent ì„¸ì…˜ ìƒì„± & ì‹¤í–‰
    Agent->>Agent: 4. ë…ë¦½ì ìœ¼ë¡œ ì‘ì—… (Hook ëª¨ë¦„)
    Agent->>System: 5. ê²°ê³¼ ë°˜í™˜
    System->>System: 6. postToolUse Hook ì‹¤í–‰ âœ…
    System->>Main: 7. ê²°ê³¼ ì „ë‹¬
          </div>
        </div>

        <div class="callout callout-info">
          <div class="callout-title">â„¹ï¸ í•µì‹¬</div>
          <div class="callout-content">
            <p>Hookì€ ëª¨ë¸ì´ ì•„ë‹Œ <strong>ì‹œìŠ¤í…œ(Runtime)ì´ ë°œë™</strong>í•©ë‹ˆë‹¤. ëª¨ë¸ì´ ìš°íšŒ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
          </div>
        </div>

        <h3 id="hook-filtering">4.6 ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì»¨í…ìŠ¤íŠ¸ í•„í„°ë§</h3>

        <p>ëª¨ë“  ë„êµ¬ í˜¸ì¶œì— Hookì´ ë°œë™ë˜ë¯€ë¡œ, ìŠ¤í¬ë¦½íŠ¸ì—ì„œ í•„í„°ë§ì´ í•„ìš”í•©ë‹ˆë‹¤:</p>

        <pre><code class="language-javascript">// .claude/scripts/post-validate.js
const input = JSON.parse(process.env.CLAUDE_TOOL_INPUT || '{}');
const output = process.env.CLAUDE_TOOL_OUTPUT || '';

// íŠ¹ì • ì›Œí¬í”Œë¡œìš°ë§Œ ì œì–´
if (input.prompt?.includes('[AUDIT]')) {
  // ê²€ì¦ ë¡œì§
  if (output.includes('ERROR') || !output.includes('ì™„ë£Œ')) {
    console.error("ê²€ì¦ ì‹¤íŒ¨");
    process.exit(1);
  }
  console.log("ê²€ì¦ í†µê³¼");
  process.exit(0);
} else {
  // ë‚˜ë¨¸ì§€ëŠ” ê·¸ëƒ¥ í†µê³¼
  process.exit(0);
}</code></pre>

        <h3 id="hook-state">4.7 ìƒíƒœ ê´€ë¦¬ (.claude/state.json)</h3>

        <p>Hook ê°„ ìƒíƒœ ê³µìœ ë¥¼ ìœ„í•œ íŒŒì¼ ê¸°ë°˜ ìƒíƒœ ê´€ë¦¬:</p>

        <pre><code class="language-javascript">// .claude/scripts/post-validate.js
const fs = require('fs');
const STATE_FILE = '.claude/state.json';

// ìƒíƒœ ì½ê¸°
function getState() {
  if (fs.existsSync(STATE_FILE)) {
    return JSON.parse(fs.readFileSync(STATE_FILE));
  }
  return { retryCount: 0, checkpoints: [] };
}

// ìƒíƒœ ì €ì¥
function saveState(state) {
  fs.writeFileSync(STATE_FILE, JSON.stringify(state, null, 2));
}

// ì‚¬ìš© ì˜ˆì‹œ
const state = getState();
if (state.retryCount >= 3) {
  console.log("ìµœëŒ€ ë°˜ë³µ íšŸìˆ˜ ë„ë‹¬");
  process.exit(1);
}
state.retryCount++;
saveState(state);</code></pre>
      </section>

      <!-- Section 5: ê³ ê¸‰ ì›Œí¬í”Œë¡œìš° íŒ¨í„´ -->
      <section id="advanced">
        <h2>5. ê³ ê¸‰ ì›Œí¬í”Œë¡œìš° íŒ¨í„´</h2>

        <h3 id="branching">5.1 ë¶„ê¸° (Branching)</h3>

        <p>ì¡°ê±´ì— ë”°ë¼ ë‹¤ë¥¸ Agent í˜¸ì¶œ:</p>

        <div class="diagram-wrapper">
          <div class="diagram-title">ğŸ“Š ë¶„ê¸° íŒ¨í„´</div>
          <div class="mermaid">
flowchart TB
    Input["ì…ë ¥ ë¶„ì„"]
    Input --> TypeA["íƒ€ì… A â†’ Agent A"]
    Input --> TypeB["íƒ€ì… B â†’ Agent B"]
    Input --> TypeC["íƒ€ì… C â†’ Agent C"]
          </div>
        </div>

        <h3 id="validation">5.2 ê²€ì¦ (Validation)</h3>

        <p>Agent ê²°ê³¼ë¥¼ ë‹¤ë¥¸ Agentê°€ ê²€ì¦:</p>

        <div class="diagram-wrapper">
          <div class="diagram-title">ğŸ“Š ê²€ì¦ íŒ¨í„´</div>
          <div class="mermaid">
flowchart TB
    A["Agent A (ì‘ì—…)"]
    A --> B["Agent B (ê²€ì¦)"]
    B --> Pass{"í†µê³¼?"}
    Pass -->|Yes| Done["ì™„ë£Œ"]
    Pass -->|No| A
          </div>
        </div>

        <h3 id="loop-control">5.3 ë°˜ë³µ ì œí•œ (Loop Control)</h3>

        <p>ë¬´í•œ ë£¨í”„ ë°©ì§€:</p>

        <pre><code class="language-javascript">// .claude/scripts/loop-control.js
const { getState, saveState, resetState } = require('./utils');

const state = getState();

if (state.retryCount >= 3) {
  console.error("ìµœëŒ€ ë°˜ë³µ íšŸìˆ˜(3íšŒ) ì´ˆê³¼");
  resetState();
  process.exit(1);
}

state.retryCount++;
saveState(state);
process.exit(0);</code></pre>

        <h3 id="aggregation">5.4 ê²°ê³¼ ì¢…í•© (Aggregation)</h3>

        <p>ì—¬ëŸ¬ Agent ê²°ê³¼ë¥¼ í•˜ë‚˜ë¡œ:</p>

        <div class="diagram-wrapper">
          <div class="diagram-title">ğŸ“Š ê²°ê³¼ ì¢…í•© íŒ¨í„´</div>
          <div class="mermaid">
flowchart LR
    A["Agent A ê²°ê³¼"]
    B["Agent B ê²°ê³¼"]
    C["Agent C ê²°ê³¼"]

    A --> Agg["ì¢…í•© ë¡œì§"]
    B --> Agg
    C --> Agg

    Agg --> Report["ìµœì¢… ë¦¬í¬íŠ¸"]
          </div>
        </div>

        <h3 id="reflection">5.5 íšŒê³  (Reflection)</h3>

        <p>ìê¸° ìˆ˜ì • íŒ¨í„´:</p>

        <div class="diagram-wrapper">
          <div class="diagram-title">ğŸ“Š íšŒê³  íŒ¨í„´</div>
          <div class="mermaid">
flowchart TB
    A1["Agent A: ì´ˆì•ˆ ì‘ì„±"]
    A1 --> B["Agent B (ë¦¬ë·°ì–´):\n'ì´ ë¶€ë¶„ ë¬¸ì œ ìˆì–´'"]
    B --> A2["Agent A: í”¼ë“œë°± ë°˜ì˜ ìˆ˜ì •"]
    A2 --> C["Agent C: ìµœì¢… ê²€ì¦"]
          </div>
        </div>

        <h3 id="multi-branch">5.6 ë‹¤ì¤‘ ë¶„ê¸° (Multi-Branch)</h3>

        <p>ë™ì‹œì— ì—¬ëŸ¬ ê²½ë¡œë¡œ ë¶„ê¸°:</p>

        <div class="diagram-wrapper">
          <div class="diagram-title">ğŸ“Š ë‹¤ì¤‘ ë¶„ê¸° íŒ¨í„´</div>
          <div class="mermaid">
flowchart TB
    Input["ì…ë ¥"] --> Classify["ë¶„ë¥˜"]

    Classify --> A["Agent A\n(í”„ë¡ íŠ¸ì—”ë“œ)"]
    Classify --> B["Agent B\n(ë°±ì—”ë“œ)"]
    Classify --> C["Agent C\n(ì¸í”„ë¼)"]

    A --> Result["ê²°ê³¼ ì¢…í•©"]
    B --> Result
    C --> Result
          </div>
        </div>

        <h3 id="dag">5.7 ì›Œí¬íŠ¸ë¦¬/DAG</h3>

        <p>ì˜ì¡´ì„±ì´ ìˆëŠ” ë³µì¡í•œ íŒŒì´í”„ë¼ì¸:</p>

        <div class="diagram-wrapper">
          <div class="diagram-title">ğŸ“Š DAG íŒ¨í„´</div>
          <div class="mermaid">
flowchart TB
    A["A (ë¶„ì„)"]
    A --> B["B"]
    A --> C["C"]
    B --> D["D"]
    C --> E["E"]
    D --> F["F (ì¢…í•©)"]
    E --> F
          </div>
        </div>

        <h3 id="consensus">5.8 íˆ¬í‘œ/í•©ì˜ (Consensus)</h3>

        <p>ì—¬ëŸ¬ Agentì˜ ì˜ê²¬ì„ ì¢…í•©:</p>

        <div class="diagram-wrapper">
          <div class="diagram-title">ğŸ“Š íˆ¬í‘œ íŒ¨í„´</div>
          <div class="mermaid">
flowchart LR
    A["Agent A\në‹µë³€ 1"]
    B["Agent B\në‹µë³€ 2"]
    C["Agent C\në‹µë³€ 3"]

    A --> Vote["ë‹¤ìˆ˜ê²°"]
    B --> Vote
    C --> Vote

    Vote --> Decision["ìµœì¢… ê²°ì •"]
          </div>
        </div>

        <h3 id="racing">5.9 ê²½ìŸ (Racing)</h3>

        <p>ì—¬ëŸ¬ ì ‘ê·¼ë²• ì¤‘ ìµœì„  ì„ íƒ:</p>

        <ul>
          <li>ë¨¼ì € ì™„ë£Œëœ ê²°ê³¼ (ì†ë„)</li>
          <li>ê°€ì¥ ë†’ì€ ì ìˆ˜ (í’ˆì§ˆ)</li>
          <li>íŠ¹ì • ì¡°ê±´ ì¶©ì¡± (ìš”êµ¬ì‚¬í•­)</li>
        </ul>

        <h3 id="checkpoint">5.10 ì²´í¬í¬ì¸íŠ¸/ë¡¤ë°±</h3>

        <p>ê¸´ ì›Œí¬í”Œë¡œìš°ì—ì„œ ì•ˆì „ë§:</p>

        <div class="diagram-wrapper">
          <div class="diagram-title">ğŸ“Š ì²´í¬í¬ì¸íŠ¸ íŒ¨í„´</div>
          <div class="mermaid">
flowchart LR
    W1["ì‘ì—… 1"] --> CP1["ì²´í¬í¬ì¸íŠ¸ 1"]
    CP1 --> W2["ì‘ì—… 2"]
    W2 --> CP2["ì²´í¬í¬ì¸íŠ¸ 2"]
    CP2 --> W3["ì‘ì—… 3"]

    W3 -.->|ì‹¤íŒ¨ì‹œ ë¡¤ë°±| CP1
          </div>
        </div>

        <h3 id="error-handling">5.11 ì—ëŸ¬ í•¸ë“¤ë§/í´ë°±</h3>

        <p>ì‹¤íŒ¨ ì‹œ ëŒ€ì²´ ê²½ë¡œ:</p>

        <div class="diagram-wrapper">
          <div class="diagram-title">ğŸ“Š í´ë°± íŒ¨í„´</div>
          <div class="mermaid">
flowchart TB
    A["Agent A (ì£¼ ì‘ì—…)"]
    A --> Success{"ì„±ê³µ?"}
    Success -->|Yes| Done["ì™„ë£Œ"]
    Success -->|No| B["Agent B (í´ë°±)"]
    B --> Success2{"ì„±ê³µ?"}
    Success2 -->|Yes| Done
    Success2 -->|No| Human["ì¸ê°„ ê°œì… ìš”ì²­"]
          </div>
        </div>
      </section>

      <!-- Section 6: ì‹¤ì „ Hook ë¶„ê¸° íŒ¨í„´ -->
      <section id="hook-branching">
        <h2>6. ì‹¤ì „ Hook ë¶„ê¸° íŒ¨í„´</h2>

        <p>Hookì„ í™œìš©í•œ ì›Œí¬í”Œë¡œìš° ë¶„ê¸° ì œì–´ëŠ” Claude Codeì˜ ê°€ì¥ ê°•ë ¥í•œ ê¸°ëŠ¥ ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤. ì´ ì„¹ì…˜ì—ì„œëŠ” ì‹¤ì „ì—ì„œ ë°”ë¡œ í™œìš©í•  ìˆ˜ ìˆëŠ” Hook ë¶„ê¸° íŒ¨í„´ì„ ë‹¤ë£¹ë‹ˆë‹¤.</p>

        <h3 id="hook-branching-concept">6.1 Hook ë¶„ê¸° í•µì‹¬ ê°œë…</h3>

        <div class="card-highlight">
          <h4>ğŸ”‘ í•µì‹¬ ì›ë¦¬</h4>
          <ul>
            <li><strong>Hookì€ ëª¨ë¸ì´ ì•„ë‹Œ ì‹œìŠ¤í…œ(Runtime)ì´ ë°œë™</strong> - Claudeê°€ ìš°íšŒí•  ìˆ˜ ì—†ìŒ</li>
            <li><strong>Exit codeë¡œ ì‹¤í–‰ ì œì–´</strong> - <code>exit(0)</code>ì€ í—ˆìš©, <code>exit(1)</code>ì€ ì°¨ë‹¨</li>
            <li><strong>Transcript íŒŒì‹±ìœ¼ë¡œ ì¡°ê±´ ê²€ì‚¬</strong> - ì‹¤í–‰ëœ Agent ì´ë ¥ì„ ì½ì–´ ë¶„ê¸°</li>
            <li><strong>ë©”íƒ€ë°ì´í„° ê¸°ë°˜ ì œì–´</strong> - Promptì— íƒœê·¸ë¥¼ ë„£ì–´ Hookì´ ê°ì§€</li>
          </ul>
        </div>

        <h3 id="exit-code-control">6.2 Exit Code ì œì–´</h3>

        <p>Hook ìŠ¤í¬ë¦½íŠ¸ëŠ” exit codeë¡œ ì›Œí¬í”Œë¡œìš°ë¥¼ ì œì–´í•©ë‹ˆë‹¤.</p>

        <pre><code class="language-javascript">// .claude/hooks/workflow-control.mjs

// âœ… í—ˆìš© (ê³„ì† ì§„í–‰)
if (shouldContinue) {
  console.log(JSON.stringify({
    decision: "approve",
    reason: "ê²€ì¦ ì™„ë£Œ, ê³„ì† ì§„í–‰"
  }));
  process.exit(0);
}

// âŒ ì°¨ë‹¨ (ì‹¤í–‰ ì¤‘ë‹¨)
if (shouldBlock) {
  console.log(JSON.stringify({
    decision: "block",
    reason: "ì¶”ê°€ ì‘ì—… í•„ìš”: content-auditor í˜¸ì¶œ"
  }));
  process.exit(0);  // ì£¼ì˜: exit(1)ì´ ì•„ë‹Œ exit(0)ìœ¼ë¡œ Hook ìì²´ëŠ” ì„±ê³µ
}</code></pre>

        <div class="card-note">
          <p><strong>ì¤‘ìš”:</strong> <code>decision: "block"</code>ì„ ë°˜í™˜í•˜ë©´ì„œë„ <code>process.exit(0)</code>ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. <code>exit(1)</code>ì€ Hook ìŠ¤í¬ë¦½íŠ¸ ìì²´ì˜ ì—ëŸ¬ë¥¼ ì˜ë¯¸í•˜ë¯€ë¡œ, ì •ìƒì ì¸ ë¶„ê¸° ë¡œì§ì—ì„œëŠ” í•­ìƒ <code>exit(0)</code>ì„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.</p>
        </div>

        <h3 id="transcript-parsing">6.3 Transcript íŒŒì‹± ë¶„ê¸°</h3>

        <p>Transcriptë¥¼ íŒŒì‹±í•˜ì—¬ ì‹¤í–‰ëœ Agent ì´ë ¥ì„ í™•ì¸í•˜ê³  ì¡°ê±´ë¶€ë¡œ ë¶„ê¸°í•©ë‹ˆë‹¤.</p>

        <pre><code class="language-javascript">// .claude/hooks/check-workflow-completion.mjs
import fs from 'fs';

function parseAgentCalls(transcript) {
  const agentPattern = /Task\(subagent_type=['"]([^'"]+)['"]/g;
  const agents = [];
  let match;

  while ((match = agentPattern.exec(transcript)) !== null) {
    agents.push(match[1]);
  }

  return agents;
}

// Transcript ì½ê¸°
const transcriptPath = process.env.TRANSCRIPT_PATH;
const transcript = fs.readFileSync(transcriptPath, 'utf-8');

// Agent ì´ë ¥ íŒŒì‹±
const agents = parseAgentCalls(transcript);
// ì˜ˆ: ['content-creator', 'content-auditor']

// ë¶„ê¸° ë¡œì§
if (agents.includes('content-creator') && !agents.includes('content-auditor')) {
  console.log(JSON.stringify({
    decision: "block",
    reason: "content-creator ì™„ë£Œ. ë‹¤ìŒ: Task(content-auditor) í˜¸ì¶œ í•„ìš”"
  }));
  process.exit(0);
}

if (agents.includes('content-auditor') && !agents.includes('content-reviewer')) {
  console.log(JSON.stringify({
    decision: "block",
    reason: "content-auditor ì™„ë£Œ. ë‹¤ìŒ: Task(content-reviewer) í˜¸ì¶œ í•„ìš”"
  }));
  process.exit(0);
}

// ëª¨ë“  ë‹¨ê³„ ì™„ë£Œ
if (agents.includes('content-creator') &&
    agents.includes('content-auditor') &&
    agents.includes('content-reviewer')) {
  console.log(JSON.stringify({
    decision: "approve",
    reason: "âœ… 3ì¤‘ ê²€ì¦ ì™„ë£Œ!"
  }));
  process.exit(0);
}</code></pre>

        <h3 id="workflow-example">6.4 ì‹¤ì „ ì›Œí¬í”Œë¡œìš° ì˜ˆì‹œ</h3>

        <p>í€´ì¦ˆ ìƒì„± ì›Œí¬í”Œë¡œìš°ë¥¼ ì˜ˆì‹œë¡œ Hook ë¶„ê¸°ê°€ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ ì‚´í´ë´…ë‹ˆë‹¤.</p>

        <h4>ì‹œë‚˜ë¦¬ì˜¤: "ê³ ì–‘ì´ í€´ì¦ˆ 10ê°œ ë§Œë“¤ì–´ì¤˜"</h4>

        <div class="diagram-wrapper">
          <div class="diagram-title">ğŸ”„ Hook ë¶„ê¸° ì›Œí¬í”Œë¡œìš°</div>
          <div class="mermaid">
flowchart TB
    User["ì‚¬ìš©ì: ê³ ì–‘ì´ í€´ì¦ˆ 10ê°œ ë§Œë“¤ì–´ì¤˜"]

    User --> Creator["content-creator Agent ì‹¤í–‰"]
    Creator --> Quiz["í€´ì¦ˆ 10ê°œ ìƒì„± ì™„ë£Œ"]

    Quiz --> Hook1["SubagentStop Hook #1 ë°œë™"]
    Hook1 --> Check1{"Transcript í™•ì¸:\ncreatorë§Œ ìˆìŒ?"}

    Check1 -->|Yes| Block1["decision: block\nreason: auditor í˜¸ì¶œ í•„ìš”"]
    Block1 --> Claude1["Claude: auditor í˜¸ì¶œ"]

    Claude1 --> Auditor["content-auditor Agent ì‹¤í–‰"]
    Auditor --> Validate["ê²€ì¦ ì™„ë£Œ"]

    Validate --> Hook2["SubagentStop Hook #2 ë°œë™"]
    Hook2 --> Check2{"ê²½ê³  ìˆìŒ?"}

    Check2 -->|Yes| Block2["decision: block\nreason: ìˆ˜ì • í›„ ì¬ê²€ì¦"]
    Block2 --> Fix["Claude: ìˆ˜ì • í›„ auditor ì¬ì‹¤í–‰"]

    Check2 -->|No| Block3["decision: block\nreason: reviewer í˜¸ì¶œ"]
    Block3 --> Claude2["Claude: reviewer í˜¸ì¶œ"]

    Claude2 --> Reviewer["content-reviewer Agent ì‹¤í–‰"]
    Reviewer --> Review["ë¦¬ë·° ì™„ë£Œ"]

    Review --> Hook3["SubagentStop Hook #3 ë°œë™"]
    Hook3 --> Check3{"ëª¨ë“  Agent ì™„ë£Œ?"}

    Check3 -->|Yes| Approve["decision: approve\nâœ… 3ì¤‘ ê²€ì¦ ì™„ë£Œ"]
    Approve --> Done["Claude: ì‚¬ìš©ìì—ê²Œ ì™„ë£Œ ë³´ê³ "]
          </div>
        </div>

        <h4>ì‹¤ì œ ëŒ€í™” íë¦„</h4>

        <pre><code class="language-text">ğŸ‘¤ ì‚¬ìš©ì: "ê³ ì–‘ì´ í€´ì¦ˆ 5ê°œ ë§Œë“¤ì–´ì¤˜"

ğŸ¤– Claude: "content-creatorë¥¼ í˜¸ì¶œí•˜ê² ìŠµë‹ˆë‹¤."
         [Task(content-creator) ì‹¤í–‰]
         â†’ í€´ì¦ˆ 5ê°œ ìƒì„± ì™„ë£Œ

ğŸª Hook #1: decision: "block"
          reason: "content-auditor í˜¸ì¶œ í•„ìš”"

ğŸ¤– Claude: "content-auditorë¥¼ í˜¸ì¶œí•˜ê² ìŠµë‹ˆë‹¤."
         [Task(content-auditor) ì‹¤í–‰]
         â†’ ê²€ì¦ ì™„ë£Œ, ê²½ê³  0ê°œ

ğŸª Hook #2: decision: "block"
          reason: "content-reviewer í˜¸ì¶œ í•„ìš”"

ğŸ¤– Claude: "content-reviewerë¥¼ í˜¸ì¶œí•˜ê² ìŠµë‹ˆë‹¤."
         [Task(content-reviewer) ì‹¤í–‰]
         â†’ ë¦¬ë·° í†µê³¼

ğŸª Hook #3: decision: "approve"
          reason: "âœ… 3ì¤‘ ê²€ì¦ ì™„ë£Œ"

ğŸ¤– Claude: "âœ… ê³ ì–‘ì´ í€´ì¦ˆ 5ê°œ ìƒì„± ì™„ë£Œ!

         ê²€ì¦ ê²°ê³¼:
         - 1ì°¨ (content-creator): í†µê³¼
         - 2ì°¨ (content-auditor): í†µê³¼
         - 3ì°¨ (content-reviewer): í†µê³¼"</code></pre>

        <h4>ì—ëŸ¬ ë°œê²¬ ì‹œ ë¶„ê¸°</h4>

        <pre><code class="language-javascript">// Hookì—ì„œ ì—ëŸ¬ ê°ì§€
function checkWarnings(transcript) {
  const lines = transcript.split('\n');
  return lines.filter(line =>
    line.includes('âš ï¸') ||
    line.includes('ê²½ê³ ') ||
    line.includes('warning')
  );
}

const warnings = checkWarnings(transcript);

if (warnings.length > 0 && lastAgent === 'content-auditor') {
  console.log(JSON.stringify({
    decision: "block",
    reason: `content-auditorì—ì„œ ${warnings.length}ê°œ ê²½ê³  ë°œê²¬.\nìˆ˜ì • í›„ ì¬ê²€ì¦ í•„ìš”:\n${warnings.join('\n')}`
  }));
  process.exit(0);
}</code></pre>

        <h3 id="parallel-orchestration">6.5 ë³‘ë ¬ Agent ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜</h3>

        <p>Skill ë‚´ì—ì„œ ì—¬ëŸ¬ Agentë¥¼ ë³‘ë ¬ë¡œ í˜¸ì¶œí•˜ëŠ” íŒ¨í„´ì…ë‹ˆë‹¤.</p>

        <pre><code class="language-markdown"># content-workflow Skill

## ì‚¬ìš©ë²•
ì‚¬ìš©ìê°€ "ì½˜í…ì¸  ìƒì„±" ìš”ì²­ ì‹œ ì´ ì›Œí¬í”Œë¡œìš°ë¥¼ ë”°ë¥´ì„¸ìš”.

## ì›Œí¬í”Œë¡œìš°

### 1ë‹¨ê³„: ë³‘ë ¬ ìƒì„±
ë‹¤ìŒ Agentë“¤ì„ **ë³‘ë ¬ë¡œ** í˜¸ì¶œí•˜ì„¸ìš”:

```
Task(content-creator, prompt: "í€´ì¦ˆ ìƒì„± [PARALLEL:1]")
Task(seo-optimizer, prompt: "SEO ìµœì í™” [PARALLEL:1]")
Task(image-generator, prompt: "ì¸ë„¤ì¼ ìƒì„± [PARALLEL:1]")
```

### 2ë‹¨ê³„: í†µí•© ê²€ì¦
ë³‘ë ¬ ì‘ì—… ì™„ë£Œ í›„:

```
Task(content-auditor, prompt: "í†µí•© ê²€ì¦ [VERIFY]")
```

## Hook ë¶„ê¸°
- `[PARALLEL:1]`: ë³‘ë ¬ ê·¸ë£¹ 1 (ë™ì‹œ ì‹¤í–‰)
- `[VERIFY]`: ê²€ì¦ ë‹¨ê³„ (ìˆœì°¨ ì‹¤í–‰)
</code></pre>

        <p>Hookì—ì„œ ë³‘ë ¬ ì‹¤í–‰ ê°ì§€:</p>

        <pre><code class="language-javascript">// Hookì—ì„œ ë³‘ë ¬ ê·¸ë£¹ í™•ì¸
function getParallelGroup(transcript, agentName) {
  const pattern = new RegExp(`${agentName}.*\\[PARALLEL:(\\d+)\\]`);
  const match = transcript.match(pattern);
  return match ? parseInt(match[1]) : null;
}

const parallelAgents = agents.filter(a =>
  getParallelGroup(transcript, a) === 1
);

// ë³‘ë ¬ ê·¸ë£¹ 1ì˜ ëª¨ë“  Agent ì™„ë£Œ í™•ì¸
if (parallelAgents.length === 3 &&
    !agents.includes('content-auditor')) {
  console.log(JSON.stringify({
    decision: "block",
    reason: "ë³‘ë ¬ ì‘ì—… ì™„ë£Œ. content-auditor í˜¸ì¶œ í•„ìš”"
  }));
  process.exit(0);
}</code></pre>

        <div class="card-highlight">
          <h4>ğŸ’¡ ë³‘ë ¬ vs ìˆœì°¨ ì‹¤í–‰</h4>
          <ul>
            <li><strong>ë³‘ë ¬:</strong> ë…ë¦½ì ì¸ ì‘ì—…ì„ ë™ì‹œì— ì‹¤í–‰ (ì‹œê°„ ì ˆì•½)</li>
            <li><strong>ìˆœì°¨:</strong> ì´ì „ ì‘ì—… ê²°ê³¼ê°€ í•„ìš”í•œ ê²½ìš°</li>
            <li><strong>Hook ì œì–´:</strong> ë©”íƒ€ë°ì´í„° íƒœê·¸ë¡œ ì‹¤í–‰ ìˆœì„œ ê°•ì œ</li>
          </ul>
        </div>

        <div class="card-tip">
          <h4>ğŸ¯ ì‹¤ì „ íŒ</h4>
          <ul>
            <li><strong>Transcript ìºì‹±:</strong> í° TranscriptëŠ” íŒŒì‹± ë¹„ìš©ì´ ë†’ìœ¼ë¯€ë¡œ ê²°ê³¼ë¥¼ ìºì‹œ</li>
            <li><strong>ì—ëŸ¬ ë©”ì‹œì§€ ëª…í™•í™”:</strong> Hookì˜ <code>reason</code>ì„ êµ¬ì²´ì ìœ¼ë¡œ ì‘ì„±í•´ì•¼ Claudeê°€ ì˜¬ë°”ë¥´ê²Œ í–‰ë™</li>
            <li><strong>í…ŒìŠ¤íŠ¸:</strong> ê° ë¶„ê¸° ê²½ë¡œë¥¼ ì‹¤ì œë¡œ ì‹¤í–‰í•´ì„œ ê²€ì¦</li>
            <li><strong>ë¡œê¹…:</strong> Hook ì‹¤í–‰ ì´ë ¥ì„ íŒŒì¼ë¡œ ì €ì¥í•˜ë©´ ë””ë²„ê¹…ì— ìœ ìš©</li>
          </ul>
        </div>
      </section>

      <!-- Section 7: ì‹¤ì „ ì˜ˆì‹œ -->
      <section id="examples">
        <h2>7. ì‹¤ì „ ì˜ˆì‹œ</h2>

        <h3 id="example-basic">7.1 ê¸°ë³¸: ë‹¨ì¼ ê²€ì¦ (Skill + Hook)</h3>

        <p><strong>ëª©í‘œ:</strong> Task í˜¸ì¶œ ê²°ê³¼ë¥¼ ê²€ì¦í•˜ê³  ì‹¤íŒ¨ì‹œ ì¬ì‹œë„</p>

        <pre><code class="language-text">.claude/
â”œâ”€â”€ settings.json
â”œâ”€â”€ state.json
â”œâ”€â”€ skills/
â”‚   â””â”€â”€ verified-task/
â”‚       â””â”€â”€ SKILL.md
â””â”€â”€ scripts/
    â””â”€â”€ verify-result.js</code></pre>

        <p><strong>settings.json:</strong></p>
        <pre><code class="language-jsonc">{
  "hooks": {
    "postToolUse": [{
      "matcher": "Task",
      "command": "node .claude/scripts/verify-result.js"
    }]
  }
}</code></pre>

        <p><strong>verify-result.js:</strong></p>
        <pre><code class="language-javascript">const fs = require('fs');
const STATE_FILE = '.claude/state.json';

const input = JSON.parse(process.env.CLAUDE_TOOL_INPUT || '{}');
const output = process.env.CLAUDE_TOOL_OUTPUT || '';

// [VERIFY] íƒœê·¸ê°€ ìˆëŠ” ê²½ìš°ë§Œ ê²€ì¦
if (!input.prompt?.includes('[VERIFY]')) {
  process.exit(0);
}

// ìƒíƒœ ê´€ë¦¬
let state = { retryCount: 0 };
if (fs.existsSync(STATE_FILE)) {
  state = JSON.parse(fs.readFileSync(STATE_FILE));
}

// ìµœëŒ€ 3íšŒ ì¬ì‹œë„
if (state.retryCount >= 3) {
  console.error("ìµœëŒ€ ì¬ì‹œë„ íšŸìˆ˜ ì´ˆê³¼");
  fs.unlinkSync(STATE_FILE);
  process.exit(1);
}

// ì‹¤ì œ ê²€ì¦ ë¡œì§
const isValid = validateOutput(output);
if (!isValid) {
  state.retryCount++;
  fs.writeFileSync(STATE_FILE, JSON.stringify(state));
  console.error(`ê²€ì¦ ì‹¤íŒ¨. ì¬ì‹œë„ ${state.retryCount}/3`);
  process.exit(1);
}

// ì„±ê³µì‹œ ìƒíƒœ ì´ˆê¸°í™”
fs.unlinkSync(STATE_FILE);
console.log("ê²€ì¦ í†µê³¼!");
process.exit(0);

function validateOutput(output) {
  if (output.includes('ERROR') || output.includes('error')) {
    return false;
  }
  if (!output.includes('ì™„ë£Œ') && !output.includes('PASS')) {
    return false;
  }
  return true;
}</code></pre>

        <h3 id="example-intermediate">7.2 ì¤‘ê¸‰: íšŒê³  ë£¨í”„ (Reflection Loop)</h3>

        <p><strong>ëª©í‘œ:</strong> ì½”ë“œ ì‘ì„± â†’ ë¦¬ë·° â†’ ìˆ˜ì • â†’ ìµœì¢… ê²€ì¦</p>

        <pre><code class="language-yaml">---
name: reflective-coder
description: íšŒê³ ë¥¼ í†µí•´ í’ˆì§ˆì„ ë†’ì´ëŠ” ì½”ë“œ ì‘ì„±
allowed-tools: Task, Read, Write
---

# íšŒê³ í˜• ì½”ë“œ ì‘ì„±

## ì‹¤í–‰ ìˆœì„œ

### 1ë‹¨ê³„: ì´ˆì•ˆ ì‘ì„±
[REFLECT:DRAFT] íƒœê·¸ì™€ í•¨ê»˜ coder agent í˜¸ì¶œ

### 2ë‹¨ê³„: ë¦¬ë·°
[REFLECT:REVIEW] íƒœê·¸ì™€ í•¨ê»˜ reviewer agent í˜¸ì¶œ
- ë¬¸ì œì ê³¼ ê°œì„ ì‚¬í•­ì„ êµ¬ì²´ì ìœ¼ë¡œ ì§€ì 

### 3ë‹¨ê³„: ìˆ˜ì •
[REFLECT:REVISE] íƒœê·¸ì™€ í•¨ê»˜ coder agent ì¬í˜¸ì¶œ
- ë¦¬ë·° í”¼ë“œë°±ì„ ë°˜ë“œì‹œ ë°˜ì˜

### 4ë‹¨ê³„: ìµœì¢… ê²€ì¦
[REFLECT:VERIFY] íƒœê·¸ì™€ í•¨ê»˜ verifier agent í˜¸ì¶œ
- í†µê³¼ì‹œ ì™„ë£Œ
- ì‹¤íŒ¨ì‹œ 2ë‹¨ê³„ë¡œ ëŒì•„ê° (ìµœëŒ€ 2íšŒ)</code></pre>

        <h3 id="example-advanced">7.3 ê³ ê¸‰: í’€ íŒŒì´í”„ë¼ì¸</h3>

        <p><strong>ëª©í‘œ:</strong> ë‹¤ì¤‘ ë¶„ê¸° + ë³‘ë ¬ ì‹¤í–‰ + íˆ¬í‘œ + ì²´í¬í¬ì¸íŠ¸ + ì—ëŸ¬ í•¸ë“¤ë§</p>

        <div class="diagram-wrapper">
          <div class="diagram-title">ğŸ“Š í’€ íŒŒì´í”„ë¼ì¸</div>
          <div class="mermaid">
flowchart TB
    Start["ì‹œì‘"]
    Start --> CP0["ì²´í¬í¬ì¸íŠ¸ 0"]
    CP0 --> Parallel

    subgraph Parallel["ë³‘ë ¬ ì‹¤í–‰"]
        Code["ì½”ë“œ ë¶„ì„"]
        Security["ë³´ì•ˆ ê²€í† "]
        Perf["ì„±ëŠ¥ ì²´í¬"]
    end

    Parallel --> CP1["ì²´í¬í¬ì¸íŠ¸ 1"]
    CP1 --> Vote["íˆ¬í‘œ/í•©ì˜"]

    Vote --> Consensus{"í•©ì˜\në„ë‹¬?"}
    Consensus -->|Yes| Report["ìµœì¢… ë¦¬í¬íŠ¸"]
    Consensus -->|No| Resolver["consensus-resolver"]

    Resolver --> Resolved{"í•´ê²°?"}
    Resolved -->|Yes| Report
    Resolved -->|No| Human["ì¸ê°„ ê°œì…"]
          </div>
        </div>

        <h3 id="project-structure">7.4 í”„ë¡œì íŠ¸ êµ¬ì¡° ì˜ˆì‹œ</h3>

        <pre><code class="language-text">my-project/
â”œâ”€â”€ .claude/
â”‚   â”œâ”€â”€ settings.json          # Hook ì •ì˜
â”‚   â”œâ”€â”€ state.json             # ëŸ°íƒ€ì„ ìƒíƒœ (gitignore)
â”‚   â”‚
â”‚   â”œâ”€â”€ skills/
â”‚   â”‚   â”œâ”€â”€ verified-task/
â”‚   â”‚   â”‚   â””â”€â”€ SKILL.md
â”‚   â”‚   â”œâ”€â”€ reflective-coder/
â”‚   â”‚   â”‚   â””â”€â”€ SKILL.md
â”‚   â”‚   â””â”€â”€ full-audit/
â”‚   â”‚       â””â”€â”€ SKILL.md
â”‚   â”‚
â”‚   â”œâ”€â”€ agents/
â”‚   â”‚   â”œâ”€â”€ code-analyzer/
â”‚   â”‚   â”‚   â””â”€â”€ code-analyzer.md
â”‚   â”‚   â”œâ”€â”€ security-reviewer/
â”‚   â”‚   â”œâ”€â”€ performance-checker/
â”‚   â”‚   â”œâ”€â”€ reviewer/
â”‚   â”‚   â”œâ”€â”€ verifier/
â”‚   â”‚   â””â”€â”€ fallback-analyzer/
â”‚   â”‚
â”‚   â””â”€â”€ scripts/
â”‚       â”œâ”€â”€ utils.js           # ê³µí†µ ìœ í‹¸ë¦¬í‹°
â”‚       â”œâ”€â”€ verify-result.js
â”‚       â”œâ”€â”€ reflection-control.js
â”‚       â”œâ”€â”€ pipeline-controller.js
â”‚       â”œâ”€â”€ checkpoint-manager.js
â”‚       â””â”€â”€ voting-system.js
â”‚
â”œâ”€â”€ src/
â”œâ”€â”€ tests/
â””â”€â”€ package.json</code></pre>

        <div class="callout callout-warning">
          <div class="callout-title">âš ï¸ .gitignoreì— ì¶”ê°€</div>
          <div class="callout-content">
            <pre><code>.claude/state.json</code></pre>
          </div>
        </div>

        <h3 id="agent-definition">7.5 Agent ì •ì˜ íŒŒì¼ ì˜ˆì‹œ</h3>

        <p><strong>.claude/agents/code-analyzer/code-analyzer.md:</strong></p>

        <pre><code class="language-markdown">---
name: code-analyzer
description: ì½”ë“œ êµ¬ì¡°ì™€ í’ˆì§ˆì„ ë¶„ì„í•˜ëŠ” ì „ë¬¸ Agent
tools: Read, Grep, Glob
---

# Code Analyzer Agent

ë‹¹ì‹ ì€ ì½”ë“œë² ì´ìŠ¤ ë¶„ì„ ì „ë¬¸ê°€ì…ë‹ˆë‹¤.

## ë¶„ì„ í•­ëª©

1. **êµ¬ì¡° ë¶„ì„**: ë””ë ‰í† ë¦¬ êµ¬ì¡°, ëª¨ë“ˆ êµ¬ì„±
2. **ë³µì¡ë„ ë¶„ì„**: í•¨ìˆ˜ë³„ ë³µì¡ë„, ì˜ì¡´ì„±
3. **í’ˆì§ˆ ì§€í‘œ**: ì½”ë“œ ì¤‘ë³µ, ë„¤ì´ë° ì»¨ë²¤ì…˜

## ì¶œë ¥ í˜•ì‹

ë°˜ë“œì‹œ ë‹¤ìŒ JSON í˜•ì‹ìœ¼ë¡œ ê²°ê³¼ ë°˜í™˜:

```json
{
  "agent": "code-analyzer",
  "status": "pass|fail",
  "severity": "low|medium|high|critical",
  "findings": [...],
  "score": 0-100
}
```</code></pre>

        <h3 id="utils">7.6 ê³µí†µ ìœ í‹¸ë¦¬í‹° (utils.js)</h3>

        <pre><code class="language-javascript">const fs = require('fs');
const path = require('path');

const STATE_FILE = path.join(__dirname, '..', 'state.json');

function getState() {
  if (fs.existsSync(STATE_FILE)) {
    return JSON.parse(fs.readFileSync(STATE_FILE, 'utf8'));
  }
  return {
    retryCount: 0,
    phase: 'init',
    results: {},
    checkpoints: {},
    failedAgents: [],
    usedFallback: {}
  };
}

function saveState(state) {
  fs.writeFileSync(STATE_FILE, JSON.stringify(state, null, 2));
}

function resetState() {
  if (fs.existsSync(STATE_FILE)) {
    fs.unlinkSync(STATE_FILE);
  }
}

function saveCheckpoint(name) {
  const state = getState();
  state.checkpoints[name] = {
    timestamp: Date.now(),
    phase: state.phase,
    results: { ...state.results }
  };
  saveState(state);
  console.log(`[Checkpoint] ${name} ì €ì¥ë¨`);
}

function rollback(checkpointName) {
  const state = getState();
  const cp = state.checkpoints[checkpointName];
  if (cp) {
    state.phase = cp.phase;
    state.results = { ...cp.results };
    saveState(state);
    console.log(`[Rollback] ${checkpointName}ìœ¼ë¡œ ë³µêµ¬ë¨`);
    return true;
  }
  return false;
}

function getHookInput() {
  return JSON.parse(process.env.CLAUDE_TOOL_INPUT || '{}');
}

function getHookOutput() {
  return process.env.CLAUDE_TOOL_OUTPUT || '';
}

module.exports = {
  getState,
  saveState,
  resetState,
  saveCheckpoint,
  rollback,
  getHookInput,
  getHookOutput,
  STATE_FILE
};</code></pre>

        <h3 id="skill-tools">7.7 Skillì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ ë„êµ¬ ëª©ë¡</h3>

        <p><code>allowed-tools</code> í•„ë“œì— ì§€ì • ê°€ëŠ¥í•œ ë„êµ¬:</p>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>ë„êµ¬</th>
                <th>ì„¤ëª…</th>
              </tr>
            </thead>
            <tbody>
              <tr><td><code>Read</code></td><td>íŒŒì¼ ì½ê¸°</td></tr>
              <tr><td><code>Write</code></td><td>íŒŒì¼ ì“°ê¸°</td></tr>
              <tr><td><code>Edit</code></td><td>íŒŒì¼ ìˆ˜ì •</td></tr>
              <tr><td><code>Glob</code></td><td>íŒŒì¼ íŒ¨í„´ ê²€ìƒ‰</td></tr>
              <tr><td><code>Grep</code></td><td>ë‚´ìš© ê²€ìƒ‰</td></tr>
              <tr><td><code>Bash</code></td><td>ì…¸ ëª…ë ¹ ì‹¤í–‰</td></tr>
              <tr><td><code>Task</code></td><td>Agent í˜¸ì¶œ</td></tr>
              <tr><td><code>WebFetch</code></td><td>ì›¹ í˜ì´ì§€ ê°€ì ¸ì˜¤ê¸°</td></tr>
              <tr><td><code>WebSearch</code></td><td>ì›¹ ê²€ìƒ‰</td></tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- Section 8: í•œê³„ì  ë° í™•ì¥ -->
      <section id="limitations">
        <h2>8. í•œê³„ì  ë° í™•ì¥</h2>

        <h3 id="cli-limits">8.1 Claude Code CLI í•œê³„</h3>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>í•œê³„</th>
                <th>ì„¤ëª…</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Agent ë‚´ë¶€ ì œì–´ ë¶ˆê°€</strong></td>
                <td>Agent ì‹¤í–‰ ì¤‘ì—ëŠ” ê°œì… ë¶ˆê°€, ê²°ê³¼ë§Œ ë°›ìŒ</td>
              </tr>
              <tr>
                <td><strong>Hook í•„í„°ë§ ìˆ˜ë™</strong></td>
                <td>ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì§ì ‘ ì»¨í…ìŠ¤íŠ¸ íŒë‹¨ í•„ìš”</td>
              </tr>
              <tr>
                <td><strong>ìƒíƒœ ê´€ë¦¬ íŒŒì¼ ê¸°ë°˜</strong></td>
                <td>ë³µì¡í•œ ìƒíƒœëŠ” ê´€ë¦¬ ì–´ë ¤ì›€</td>
              </tr>
              <tr>
                <td><strong>í”„ë¡¬í”„íŠ¸ ì˜ì¡´</strong></td>
                <td>Skill ì§€ì‹œë¥¼ Claudeê°€ í•´ì„, 100% ë³´ì¥ ì•„ë‹˜</td>
              </tr>
            </tbody>
          </table>
        </div>

        <h3 id="agent-sdk">8.2 Agent SDKë¡œ ì „í™˜ ì‹œì </h3>

        <p>ë‹¤ìŒ ê²½ìš° Agent SDK (Python/TypeScript) ê³ ë ¤:</p>

        <ul>
          <li><strong>ì •ë°€í•œ ì œì–´ í•„ìš”</strong>: ë°˜ë³µ, ë¶„ê¸°ë¥¼ ì½”ë“œë¡œ ì™„ì „ ì œì–´</li>
          <li><strong>ë³µì¡í•œ ìƒíƒœ ê´€ë¦¬</strong>: ë©”ëª¨ë¦¬, DB ì—°ë™</li>
          <li><strong>ì™¸ë¶€ ì‹œìŠ¤í…œ í†µí•©</strong>: API, ì›¹í›… ë“±</li>
          <li><strong>í”„ë¡œë•ì…˜ ë°°í¬</strong>: ì•ˆì •ì„±, ëª¨ë‹ˆí„°ë§ í•„ìš”</li>
        </ul>

        <pre><code class="language-python"># Agent SDK ì˜ˆì‹œ
from claude_agent_sdk import query

async def controlled_workflow():
    for i in range(3):  # ì •í™•íˆ 3íšŒ
        result = await run_agent("analyzer")
        if validate(result):
            break
    return result</code></pre>

        <h3 id="mcp-extension">8.3 MCPë¡œ í™•ì¥</h3>

        <p>MCP(Model Context Protocol)ë¥¼ ì—°ë™í•˜ë©´:</p>

        <ul>
          <li>ì™¸ë¶€ DB ì¡°íšŒ</li>
          <li>API í˜¸ì¶œ</li>
          <li>ìŠ¬ë™/ì´ë©”ì¼ ì•Œë¦¼</li>
          <li>ì»¤ìŠ¤í…€ ë„êµ¬ ì¶”ê°€</li>
        </ul>

        <div class="callout callout-tip">
          <div class="callout-title">ğŸ’¡ ë‹¤ìŒ ë‹¨ê³„</div>
          <div class="callout-content">
            <p><a href="mcp-guide.html">MCP ì—°ê³„ ê°€ì´ë“œ</a>ì—ì„œ ìì„¸í•œ ë‚´ìš©ì„ í™•ì¸í•˜ì„¸ìš”.</p>
          </div>
        </div>
      </section>

      <!-- Summary -->
      <section id="summary" style="margin-top: 3rem; padding: 2rem; background: var(--color-bg-secondary); border-radius: var(--radius-xl);">
        <h2 style="margin-top: 0;">ğŸ“ ìš”ì•½</h2>

        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>êµ¬ì„± ìš”ì†Œ</th>
                <th>ì—­í• </th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><strong>Skill</strong></td>
                <td>ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°, ì›Œí¬í”Œë¡œìš° ì •ì˜</td>
              </tr>
              <tr>
                <td><strong>Agent</strong></td>
                <td>ë…ë¦½ëœ ì‘ì—…ì, ì „ë¬¸ ì˜ì—­ ë‹´ë‹¹</td>
              </tr>
              <tr>
                <td><strong>Hook</strong></td>
                <td>ì‹œìŠ¤í…œ ë ˆë²¨ ì œì–´, ê²€ì¦/ë¶„ê¸°/ë°˜ë³µ</td>
              </tr>
              <tr>
                <td><strong>Script</strong></td>
                <td>Hookì˜ ì‹¤ì œ ë¡œì§, ìƒíƒœ ê´€ë¦¬</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="callout callout-info" style="margin-bottom: 0;">
          <div class="callout-title">ğŸ”‘ í•µì‹¬ ê³µì‹</div>
          <div class="callout-content">
            <p style="font-size: 1.1rem; font-weight: 600; text-align: center; margin: 0;">
              ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì›Œí¬í”Œë¡œìš° = Skill (ì§„ì…ì ) + Agent (ì‘ì—…ì) + Hook (ì œì–´) + Script (ë¡œì§)
            </p>
          </div>
        </div>
      </section>

      <!-- Footer Navigation -->
      <nav class="footer-nav" aria-label="ë¬¸ì„œ ë„¤ë¹„ê²Œì´ì…˜">
        <a href="index.html" class="footer-nav-link prev">
          <span class="footer-nav-label">â† ì´ì „</span>
          <span class="footer-nav-title">í™ˆìœ¼ë¡œ</span>
        </a>
        <a href="mcp-guide.html" class="footer-nav-link next">
          <span class="footer-nav-label">ë‹¤ìŒ â†’</span>
          <span class="footer-nav-title">MCP ì—°ê³„ ê°€ì´ë“œ</span>
        </a>
      </nav>
    </div>
  </main>

  <!-- Back to Top -->
  <button class="back-to-top" aria-label="ë§¨ ìœ„ë¡œ">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <polyline points="18 15 12 9 6 15"></polyline>
    </svg>
  </button>

  <!-- Search Modal -->
  <div class="search-modal" role="dialog" aria-modal="true" aria-label="ê²€ìƒ‰">
    <div class="search-modal-content">
      <div class="search-input-wrapper">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="m21 21-4.35-4.35"></path>
        </svg>
        <input type="text" class="search-input" placeholder="ë¬¸ì„œ ê²€ìƒ‰..." aria-label="ê²€ìƒ‰ì–´ ì…ë ¥">
      </div>
      <div class="search-results"></div>
      <div class="search-footer">
        <span><kbd>â†‘â†“</kbd> ì´ë™</span>
        <span><kbd>Enter</kbd> ì„ íƒ</span>
        <span><kbd>Esc</kbd> ë‹«ê¸°</span>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-javascript.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-json.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-yaml.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-python.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markdown.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-bash.min.js"></script>

  <script src="assets/js/config.js"></script>
  <script src="assets/js/main.js"></script>
  <script src="assets/js/sidebar.js"></script>
  <script src="assets/js/card-tabs.js"></script>
  <script src="assets/js/search.js"></script>
  <script src="assets/js/code-block.js"></script>

  <script>
    // Mermaid ì´ˆê¸°í™”
    mermaid.initialize({
      startOnLoad: true,
      theme: document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default',
      securityLevel: 'loose',
      flowchart: {
        useMaxWidth: true,
        htmlLabels: true,
        curve: 'basis'
      }
    });
  </script>

  <!-- PWA Service Worker Registration -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
          .then((registration) => {
            console.log('Service Worker ë“±ë¡ ì„±ê³µ:', registration.scope);
          })
          .catch((error) => {
            console.log('Service Worker ë“±ë¡ ì‹¤íŒ¨:', error);
          });
      });
    }
  </script>
</body>
</html>
